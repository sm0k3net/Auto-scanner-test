const express = require('express');
const { exec } = require('child_process');
const config = require('../../config/config.json');
const router = express.Router();

router.post('/searchsploit', async (req, res) => {
  const { cve } = req.body;
  exec(`${config.searchsploitPath} ${cve} -j`, (err, stdout, stderr) => {
    if (err) return res.status(500).json({ error: stderr });
    res.json({ result: JSON.parse(stdout) });
  });
});

router.post('/auto', async (req, res) => {
  res.json({ status: 'not_implemented', message: 'Auto exploitation is not implemented for safety.' });
});

module.exports = router;